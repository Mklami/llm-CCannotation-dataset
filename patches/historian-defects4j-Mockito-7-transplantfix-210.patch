--- a/src/org/mockito/internal/util/reflection/GenericMetadataSupport.java
+++ b/src/org/mockito/internal/util/reflection/GenericMetadataSupport.java
@@ -179,7 +179,8 @@
     }
 
     protected Type getActualTypeArgumentFor(TypeVariable typeParameter) {
-        Type type = this.contextualActualTypeParameters.get(typeParameter);
+        registerTypeVariableIfNotPresent(typeParameter);
+Type type = this.contextualActualTypeParameters.get(typeParameter);
         if (type instanceof TypeVariable) {
             TypeVariable typeVariable = (TypeVariable) type;
             return getActualTypeArgumentFor(typeVariable);



